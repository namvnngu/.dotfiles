#!/usr/bin/env bash

# Author: Nam Nguyen <vnngucs@outlook.com>
# Description: Find and copy something
# License: The Unlicense
# Date created: July 22, 2024
# Date modified: August 23, 2025

fcp_dir="$DOTFILES_PATH/bin/resources"

if [[ $1 == "ls" ]]; then
  find "$fcp_dir" -maxdepth 1 -name "fcp-*" | sed "s/^.*fcp-//" | git column --mode=column --padding=5
  exit 0
fi

category="$1"
fcp_file="$fcp_dir/fcp-$category"

# Fuzzy search

if [[ $# -eq 0 ]]; then
  files=$(find "$fcp_dir" -maxdepth 1 -name "fcp-*" -exec cat {} '+')
  selected=$(echo "$files" | fzf)
elif [[ -e "$fcp_file" ]]; then
  selected=$(fzf < "$fcp_file")
else
  echo "$fcp_file: No such file"
  exit 1
fi

if [[ -z "$selected" ]]; then
  exit 1
fi

selected=${selected/%: */}

# Copy

os=$(uname -s)
case "$os" in
  Darwin*)
    echo -n "$selected" | pbcopy
    ;;
  Linux*)
    echo -n "$selected" | xclip -selection clipboard
    ;;
esac
echo "Copied to clipboard: $selected"
