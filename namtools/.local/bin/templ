#!/usr/bin/env bash

# Author: Nam Nguyen <nguyenvietnam2401@gmail.com>
# Description: Create a file given a template name
# License: MIT License
# Date Created: December 01, 2025
# Date Modified: December 01, 2025

cmd="$(basename "${0}")"
version="0.1.0"
template_dir="${NAMTOOLS_DATA_DIR}"

# Exits with status 1 and messages.
#
# Usage: exit-1 [message...]
#
# Arguments:
#   [message...]  Error messages
exit-1() {
  {
    printf "${cmd}: "
    printf "%s\n" "${@}"
  } 1>&2
  exit 1
}

# Prints the usage information.
#
# Usage: print-help
print-help() {
  printf "${cmd} - Create a file given a template name [version ${version}]

Usage: 
  ${cmd} [options]
  ${cmd} template_name file_path

Arguments:
  template_name  Template name
  file_path      Path of a file created based on template_name

Options: 
  -h, --help     Print usage information
  -v, --version  Print version
"
}

# Prints the version.
#
# Usage: print-version
print-version() {
  printf "${cmd} ${version}\n"
}

main() {
  if (( $# <= 1 )); then
    local option="${1}"

    case "${option}" in
      --version | -v)
        print-version
        ;;
      *)
        print-help
        ;;
    esac

    exit
  fi

  local template_name="${1}"
  local file_path="${2}"
  local template_file="${template_dir}/templ-${template_name}.txt"

  if [[ ! -e "${template_file}" ]]; then
    exit-1 "${template_file}: No such file"
  fi

  mkdir -p $(dirname "${file_path}")
  cp "${template_file}" "${file_path}"
}

main "$@"
